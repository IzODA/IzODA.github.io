<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Stephen Stone" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Installation and Configuration - IzODA Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Installation and Configuration";
        var mkdocs_page_input_path = "anaconda\\install-config.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> IzODA Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Migration to new offerings</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/spark_mig/">Apache Spark</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/ODL_mig/">ODL/MDS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/anaconda_mig/">Anaconda</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Apache Spark</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../spark/spark/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../spark/jupyter-remote-notebook/">Jupyter with Remote Notebook on the Mainframe</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../spark/wlm-metering/">WLM Metering and Capping for IzODA Spark</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Optimized Data Layer / MDS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../odl/odl/">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Anaconda</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../anaconda/">Overview</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Installation and Configuration</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#environmental-setup">Environmental Setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#download-and-unpack">Download and Unpack</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#install">Install</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#post-smpe-installation-instructions">Post-SMP/E Installation Instructions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#activate-an-environment">Activate an Environment</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#latebreaking-news">Latebreaking News</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#applying-maintenance">Applying maintenance</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#maintaining-the-correct-file-ownership">Maintaining the correct file ownership</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#terminology">Terminology</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../packages/">Available Packages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-jupyter-notebook/">Using R in Jupyter Notebook</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../optional-packages/">Optional Package Guides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../apar-notes/">APAR Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../izoda-extras/">izoda-extras</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../jkg2at-migration/">JKG2AT Migration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ivp-jupyter-notebook/">Anaconda/ODL Installation Verification with Jupyter Notebook</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ivp-pyspark/">IzODA Installation Verification with PySpark</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../ecosystem/">Ecosystem</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Best Practices</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../best-practices/jupyter-notebook-usage/">Jupyter Notebook Usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../best-practices/hlq-c-libraries/">HLQ xlc for C Libraries</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../best-practices/vegas-support/">Vegas Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../best-practices/modify-base-env/">Modifying the Base Environment</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">IzODA Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Anaconda &raquo;</li>
      <li>Installation and Configuration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="anaconda-installation-and-configuration">Anaconda Installation and Configuration</h1>
<p>This process installs all of the components of a fully functional Anaconda deployment. There are some key characteristics of the z/OS environment to be aware of:</p>
<ul>
<li>All Anaconda components are 64-bit ASCII applications.</li>
<li>Since Anaconda is an ASCII environment running on a platform with a default EBCDIC code page, file tagging is used extensively. Be aware that newly created files in this environment must be properly tagged for everything to run smoothly.</li>
<li>These instructions are for a system administrator running in a z/OS shell. They are tailored for a bash shell instance. If you are using the default <em>tcsh</em> that comes with z/OS, substitute the <em>setenv</em> command for <em>export</em>.</li>
<li>Proper WLM classification of Python workloads depends on how the tasks and processes associated with the application are named. By default, all such tasks will be associated with the name of the invoking user. However, this gives no indication to WLM that the given task is part of a Python workload. See the environmental setup section below for an explanation about how to associate a job name with the tasks of your Python application that WLM can recognize.</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>The <a href="http://www-01.ibm.com/support/docview.wss?uid=isg1_ZODAV1R1_HANA110">PSP bucket for Anaconda 1.1.0</a> should be reviewed prior to installation; see also the <a href="#latebreaking-news">Latebreaking News</a> section of this page.</li>
<li>IzODA installs Anaconda from a local archive shipped as part of the SMP/E offering. Because of this, the install process requires room for the archive, plus about the same amount of space in the target file system that contains the Anaconda home directory - usually <em>/usr/lpp/IBM/izoda/anaconda</em>. Since Anaconda ships with approximately 295 packages, a finished install consumes between 2.5 and 3 GB.</li>
<li>In addition to the disk space required during the IzODA install, it's important to remember that Anaconda keeps all package versions that have been installed from the IzODA channel through the conda command. This allows previous versions of an installed package to be referenced in addition to the latest version. Be sure to give Anaconda enough room to operate. The minimum disk space for an Anaconda installation is 6 GB, and the recommended amount is 20 GB.</li>
<li>Python makes use of the <em>/dev/urandom</em> character special file to read pseudo-random values for use in a variety of applications. The <em>Integrated Cryptographic Service Facility (ICSF)</em> service of z/OS must be started for <em>/dev/urandom</em> to function properly. Failures will occur if ICSF is not active when Anaconda is installed.</li>
</ul>
<pre><code>     head -c40 /dev/urandom
     head: /dev/urandom: EDC5157I An internal error has occurred.
</code></pre>
<ul>
<li>The pre-requisite level of bash is 4.2.53. This is the version installed as the default during Anaconda installation. A 4.3.46 version of bash is also included as an Anaconda package that can be installed via conda.</li>
</ul>
<h2 id="environmental-setup">Environmental Setup</h2>
<p>This is the setup necessary for any user to run Python applications and make use of other Anaconda functions:</p>
<ul>
<li>Include this setup in your .bashrc profile to make file conversion and tagging transparent to your Python application:</li>
</ul>
<pre><code>     export _CEE_RUNOPTS=&quot;FILETAG(AUTOCVT,AUTOTAG) POSIX(ON)&quot;
     if [[ -z ”$_BPXK_AUTOCVT&quot;]]; then
       export _BPXK_AUTOCVT=ON
       exec $BASH &quot;$@&quot;
     fi
</code></pre>
<ul>
<li>Add the Anaconda bin directory to your PATH in .bashrc:</li></li>
</ul>
<pre><code>export ANACONDA_ROOT=&quot;/usr/lpp/IBM/izoda/anaconda&quot;
export PATH=$ANACONDA_ROOT/bin:$PATH
</code></pre>
<ul>
<li>The Anaconda bin directory doesn't have to be first in your PATH, but if there are other shells or versions of bash installed on the system, the Anaconda bin directory has to preceed them in the PATH. Note: substitute the actual path to the Anaconda root from your environment when exporting ANACONDA_ROOT.</li>
<li>Most Python applications will use the Optimized Data Layer to access data sources on z/OS and from remote servers. These call to ODL through the dsdbc api. Set up your STEPLIB to include the load library for this interface in .bashrc:</li>
</ul>
<pre><code>export STEPLIB=hlq.SAZKLOAD:$STEPLIB
</code></pre>
<p>where hlq is the high-level qualifier of the ODL (MDS) installation.
- Grant users running Python applications READ permission to the BPX.JOBNAME facility class profile so that they can assign jobnames to their workload. Please see the <a href="https://www.ibm.com/support/knowledgecenter/SSLTBW_2.1.0/com.ibm.zos.v2r1.bpxb200/bpxenv.htm">_BPX environment variables section</a> of the z/OS UNIX System Services Planning guide for more information. Note: superusers are allowed to set jobnames regardless of their access to BPX.JOBNAME. <strong>In general, we recommend against Python users having superuser privileges.</strong></p>
<h3 id="download-and-unpack">Download and Unpack</h3>
<p>IzODA installs using SMP/E. Instructions are in the <a href="https://www-304.ibm.com/servers/resourcelink/svc00100.nsf/pages/izodav110gi134348/$file/azk1e100.pdf">Program Directory.</a> The <a href="http://www-01.ibm.com/support/docview.wss?uid=isg1_ZODAV1R1_HANA110">PSP bucket for Anaconda 1.1.0</a> should be reviewed prior to installation; see also the <a href="#latebreaking-news">Latebreaking News</a> section of this page.</p>
<h3 id="install">Install</h3>
<p>The SMP/E jobs need to be run in order. Each job includes its own instructions at the top.</p>
<h3 id="post-smpe-installation-instructions">Post-SMP/E Installation Instructions</h3>
<p>Anaconda requires a post-install script be run after the SMP/e installation has been completed. This script known as the Anaconda configuration script, must be run after service is applied to Anaconda via SMP/e. The script does the following:</p>
<ul>
<li>Creates a "local file channel" in the Anaconda root directory (if it does not already exist). This channel will contain all of the Anaconda packages delivered via SMP/E.</li>
<li>Updates the local file channel to contain the most recently delivered Anaconda packages.</li>
<li>Ensures that the file ownership and permission attributes are correct for all of the installed Anaconda packages.</li>
<li>Updates the Anaconda "root environment" to contain the most recently delivered Anaconda packages. </li>
<li>Creates an alternative environment in the Anaconda root directory the corresponds to the updated Anaconda root environment. The first time the script is run, it also creates alternative environments that correspond to the previously delivered service levels. These alternative environments can be used by Anaconda users to run their code using packages that correspond to service levels other than the default ("root") level.</li>
<li>Performs any other release-specific actions necessary to keep the Anaconda system functioning properly.</li>
</ul>
<p>The following steps must be followed before running the script:</p>
<ol>
<li>
<p>Log into Unix System Services with a Userid with "superuser" authority and become the superuser by typing the <code>su</code> command. </p>
</li>
<li>
<p>Navigate to the Anaconda root directory. i.e. <code>/usr/lpp/IBM/izoda/anaconda</code>
     <code>cd  /usr/lpp/IBM/izoda/anaconda</code></p>
</li>
<li>
<p>Create a deployment_prefix file by issuing the following command:
     <code>./configure-anaconda --set-prefix  /usr/lpp/IBM/izoda/anaconda</code></p>
</li>
<li>
<p>Configure Anaconda and install packages delivered by SMP/e:
     <code>./configure-anaconda</code></p>
</li>
</ol>
<p>Note, depending on how many maintenance releases were installed, this step may take an hour or two.</p>
<h3 id="activate-an-environment">Activate an Environment</h3>
<p>A successful Anaconda installation results in a root environment that includes all of the packages shipped with IzODA. The root environment can be activated with the Anaconda <em>activate</em> command.</p>
<p><em>Note: as a temporary restriction, anaconda commands must be run from a bash sub-shell. If you have established a login with one bash session active, run bash again from the command line to create the necessary shell nesting before using Anaconda commands.</em></p>
<p>In order to affect the current shell environment, the Anaconda activate command must be run using the <em>source</em> bash built in:</p>
<pre><code>/home/condausr&gt; bash
/home/condausr&gt; source activate root
(root) /home/condausr&gt;
</code></pre>
<p>Note that the name of the active Anaconda environment is in parentheses before any command line prompt that you have have set up. At this point, any packages in the active environment are available to applications that you may want to run.</p>
<p>In order to exit the root environment and return to you original shell, use the Anaconda <em>deactivate</em> command:</p>
<pre><code>(root) /home/condausr&gt; source deactivate root
/home/condausr&gt;
</code></pre>
<p>A complete description of conda and its functions is available in the <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/index.html">conda User Guide</a>.</p>
<h3 id="latebreaking-news">Latebreaking News</h3>
<p>This section augments information in the <a href="http://www-01.ibm.com/support/docview.wss?uid=isg1_ZODAV1R1_HANA110">PSP bucket for Anaconda 1.1.0</a>.</p>
<h3 id="applying-maintenance">Applying maintenance</h3>
<p>Anaconda takes a new approach to software maintenance. Rather than require all users on a system to use the same version of a given tool, Anaconda allows each user to select whatever version they wish to run, by controlling the content of their *conda environment. Users can create as many environments as they wish, potentially using different versions of tools for different task.</p>
<p>This means that installing new versions of the tools and packages controlled by conda <em>adds the new versions to the system without removing old versions</em>. This allows users to transition to new versions on their own schedule.</p>
<p>That said, the <em>default</em> environment (also known as the <em>root</em> environment) is managed by the system administrator, and usually provides the most recent versions of tools.</p>
<p>The preferred means of installing new code into the conda root environment is by using the <em>conda update</em> command. This will obtain the latest versions of packages and tools from a <em>channel</em>. IBM provides the <a href="https://anaconda.org/izoda/repo?type=conda&amp;label=main">IzODA channel on the Anaconda cloud</a>, which will be updated regularly with new packages, and new versions of existing packages. This channel is enabled by default when Anaconda is first installed.</p>
<p>However, not all installations will choose to install maintenance via the Internet. For such installations, IBM will provide regular PTFs for use with SMP/E.</p>
<p>Note, however, that installing maintenance via PTF will disable default access to the IzODA channel, under the presumption that subsequent maintenance will also be applied via SMP/E. Access can be restored by <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html#channel-locations-channels">altering the conda configuration file.</a></p>
<h3 id="maintaining-the-correct-file-ownership">Maintaining the correct file ownership</h3>
<p>If Anaconda is installed and maintained by a userid other than root, installation of maintenance will generally result in files in the Anaconda root directory having the owner and group IDs of that userid.</p>
<p>If, on the other hand, Anaconda is installed and maintained by root, files created or modified by installing maintenance (either via conda update or SMP/E) may produce files whose user and owner IDs are determined by the system that created the package. This is not desirable. To avoid this situation, execute the following commands, as root after installing maintenance:</p>
<pre><code>cd /usr/lpp/IBM/izoda/anaconda   # or the Anaconda root directory, if changed
chown -R 0:0
</code></pre>
<p>This will force the uid/gid for all of the files in the entire Anaconda root directory (and subdirectories) to 0, which is reserved for root.</p>
<h3 id="terminology">Terminology</h3>
<p><strong>root</strong></p>
<p>The term <em>root</em> has one of three meanings, in the context of Anaconda:</p>
<ul>
<li>root can mean the <em>root userid</em>. This user has uid 0. However, in z/OS, there are other ways to get all privileges, and the use of uid of 0 is less common</li>
<li>root can mean the <em>Anaconda root directory</em>. This is usually /usr/lpp/IBM/izoda/anaconda. It can be changed at installation time, and will often be temporarily different while service is being applied.</li>
<li>root can mean the <em>root conda environment</em>. When you run the script named activate to activate a conda environment, it sets an environment variable that causes bash to print the environment name in parenthesis. The default environment is named root.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../anaconda/" class="btn btn-neutral float-left" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../packages/" class="btn btn-neutral float-right" title="Available Packages">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../anaconda/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../packages/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../create-package-table.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
